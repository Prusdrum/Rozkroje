extends layout

block content
    div#app
        div.container
            div
                a.language-link(href="en") en
                a.language-link(href="pl") pl
            div.jumbotron.text-center
                h1 #{translations('division.header')}
            div.row
                div.col-md-12
                    div.panel.panel-primary
                        div.panel-heading(data-bind="click: toggleConfig.bind($data)")
                            span.glyphicon.glyphicon-cog  #{translations('division.configuration')}
                        div.panel-body(data-bind="visible: showConfiguration")
                            div.form-inline
                                div.form-group.col-md-5
                                    label.control-label(for="referenceLength") #{translations('division.referenceElementLength')}: &nbsp;
                                    div.input-group
                                        input#referenceLength.form-control(type="number", min="0", step="100", data-bind="value: referenceLength")
                                        span.input-group-addon mm
            div.row
                div.col-md-12
                    div.panel.panel-primary
                        div.panel-heading(data-bind="click: toggleInputSection.bind($data)")
                            span.glyphicon.glyphicon-log-in  #{translations('division.inputData')}
                        div.panel-body(data-bind="visible: showInputSection")
                            div.row
                                div.col-md-3
                                    div#inputTable.hot.handsontable.htRowHeaders.htColumnHeaders
                                div.col-md-3
                                    button.btn.btn-success(type="button", data-bind="click: sendData.bind($data)") 
                                        // ko if: showLoader()
                                        span.glyphicon.glyphicon-cog.spin
                                        // /ko
                                        // ko if: !showLoader()
                                        span &nbsp;#{translations('division.calculate')}
                                        // /ko
                                    button.btn.btn-danger(type="button", data-bind="click: resetData.bind($data)") #{translations('division.reset')}
            div.row
                div.col-md-12
                    div.panel.panel-primary
                        div.panel-heading(data-bind="click: toggleResultSection.bind($data)")
                            span.glyphicon.glyphicon-log-out  #{translations('division.result')}
                        div.panel-body(data-bind="visible: showResultSection")
                            div#stats.row.space-below(data-bind="if: result().length > 0")
                                div.col-md-12
                                    p
                                        span #{translations('division.wasteSumInMeters')}: 
                                        strong(data-bind="text: stats.wasteSumInMeters() + 'm'")
                                    p
                                        span #{translations('division.referenceElementsNeeded')}: 
                                        strong(data-bind="text: stats.countSum()") 
                                        //translate it
                                        span(data-bind="text: ' (o długości ' + referenceLength() + 'mm)'") 
                                    p
                                        span #{translations('division.materialSumInMeters')}: 
                                        strong(data-bind="text: stats.materialSumInMeters() + 'm'")
                            div.row.space-below
                                div.col-md-12
                                    buton.btn.btn-default(data-bind="click: copyResult.bind($data)") 
                                        span.glyphicon.glyphicon-copy 
                                        span #{translations('division.copy')}
                            div.row
                                div.col-md-12
                                    table.table.table-striped#resultTable
                                        thead
                                            tr
                                                th #{translations('division.pattern')}
                                                th #{translations('division.amount')}
                                                th #{translations('division.waste')}
                                        tbody(data-bind="foreach: { data: result, as: 'pattern'} ")
                                            tr
                                                td(data-bind="text: pattern.elements.join(', ')")
                                                td(data-bind="text: `x${pattern.count}`")
                                                td(data-bind="text: `${pattern.waste} mm`")

block footer
    script.
        var settings = {
            locale: '#{locale}'
        }

    div.container
        div.footer__version
            span #{translations('version')}: 
            a(href= changelogUrl, target="_blank")= version

block scripts
    script(src="/javascripts/division.js")


